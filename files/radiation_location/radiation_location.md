# 辐射源自动定位

## 辐射源

辐射源辐射强度按照平方反比方式衰减，

## 可能的实现方法

### 1.线性化转换法（最小二乘法）

#### 1.1线性化

将平方反比公式线性化得到：

$$
\frac{1}{I}=\frac{(x-x_0)^2+(y-y_0)^2}{k}
$$

进一步展开可以得到：

$$
\frac{1}{I}=\frac{x^2+y^2}{k}-\frac{2x_0x}{k}-\frac{2y_0y}{k}+\frac{x_0^2+y_0^2}{k}
$$

作变量代换：

$$
A=\frac{1}{k},B=-\frac{2x_0}{k},C=-\frac{2y_0}{k},D=\frac{x_0^2+y_0^2}{k}
$$

则：

$$
\frac{1}{I}=A(x^2+y^2)+Bx+Cy+D
$$

#### 1.2最小二乘法求解参数

对于每一个数据点$(x_i,y_i,I_i)$，构建线性方程：

$$
A(x_i^2+y_i^2)+Bx_i+Cy_i+D=\frac{1}{I_i}
$$

求解参数$A,B,C,D$，使得方程的残差平方和最小。
反向计算辐射源参数：

$$
x_0=-\frac{B}{2A},y_0=-\frac{C}{2A},k=\frac{1}{A}
$$

进一步可以验证

$$
D=\frac{B^2+C^2}{4A}
$$

是否在精度范围内成立从而检查合理性

#### 1.3优势与不足

计算复杂度低O(n)，适合百万级数据点，可在毫秒级完成

### 2.非线性优化法

将线性化结果作为初值，优化目标函数，使得目标函数最小：

$$
min_{x_0,y_0,k}\sum_{i=1}^N I_i-\frac{k_1}{(x_i-x_1)^2+(y_i-y_1)^2}
$$

已经在Python环境中实现了非线性优化方法，采用了Levenberg-Marquardt算法进行优化使得残差最小。但是目前存在一定的不足：

1. 需要较多观测点（20～30）才能够进行比较精确的预报
2. 观测点之间的关系（比如线性关系）可能会对下降的结果造成某种影响
